# Cook environment container
# This image has basic dev tools and coding agents pre-installed

FROM node:20-slim

# Install basic tools
RUN apt-get update && apt-get install -y \
    git \
    curl \
    wget \
    vim \
    neovim \
    ripgrep \
    fd-find \
    jq \
    zsh \
    sudo \
    && rm -rf /var/lib/apt/lists/*

# Install claude-code globally
RUN npm install -g @anthropic-ai/claude-code

# Create non-root user (claude refuses --dangerously-skip-permissions as root)
RUN useradd -m -s /bin/bash dev && \
    echo "dev ALL=(ALL) NOPASSWD:ALL" >> /etc/sudoers

# Create workspace directory owned by dev
RUN mkdir -p /workspace && chown dev:dev /workspace
WORKDIR /workspace

# Switch to non-root user
USER dev

# Default to keeping container alive
CMD ["sleep", "infinity"]
